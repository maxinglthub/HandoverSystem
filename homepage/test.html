<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å§‘å§‘å˜å˜(2.0) - ç¶²é ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono&family=Noto+Sans+TC:wght@400;700&display=swap');
        
        body {
            background-color: #1a1b1e;
            color: #dce1e6;
            font-family: 'Noto Sans TC', 'JetBrains Mono', 'Consolas', sans-serif;
        }
        .card {
            background-color: #25262b;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .scroll-area {
            max-height: 400px;
            overflow-y: auto;
        }
        /* è‡ªå®šç¾©æ²è»¸ */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #2c2e33; }
        ::-webkit-scrollbar-thumb { background: #4a4d53; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #5c5f66; }

        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #1971c2;
            cursor: pointer;
        }
    </style>
</head>
<body class="p-6 md:p-10">

    <div class="max-w-6xl mx-auto">
        <header class="card p-4 mb-6 flex justify-between items-center border-l-4 border-blue-500">
            <h1 class="text-xl font-bold tracking-wider">ç‰›é¦¬äº¤æ¥ç³»çµ± (Web 2.0)</h1>
            <div class="flex gap-2">
                <button onclick="playAudio()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition">
                    ğŸ”Š æ’­æ”¾éŸ³æ•ˆ
                </button>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="card p-6 flex flex-col">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold text-gray-300">å¾…è¾¦äº‹é …</h2>
                    <button onclick="importTasks()" class="text-xs text-blue-400 hover:underline">åŒ¯å…¥ tasks.txt æ ¼å¼</button>
                </div>
                <div id="task-list" class="scroll-area space-y-3 pr-2">
                    </div>
            </div>

            <div class="card p-6 flex flex-col">
                <h2 class="text-lg font-semibold mb-4 text-gray-300">è¼¸å‡ºçµæœ</h2>
                <textarea id="output-text" class="w-full h-80 bg-[#1a1b1e] text-sm p-4 rounded-lg border border-gray-700 focus:border-blue-500 outline-none resize-none font-mono" readonly></textarea>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-6">
                    <button onclick="copyText()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 rounded transition">è¤‡è£½</button>
                    <button onclick="resetTasks()" class="bg-gray-600 hover:bg-gray-700 text-white py-2 rounded transition">é‡ç½®</button>
                    <button onclick="selectAll(true)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 rounded transition">å…¨é¸</button>
                    <button onclick="selectAll(false)" class="bg-gray-600 hover:bg-gray-700 text-white py-2 rounded transition">å…¨ä¸é¸</button>
                </div>
            </div>
        </div>
    </div>

    <audio id="bg-audio" src="mp3.mp3"></audio>

    <script>
        // é è¨­è³‡æ–™ (æ¨¡æ“¬ tasks.txt)
        let tasks = [
            { label: "æª¢æŸ¥ä¼ºæœå™¨", when_checked: "- ä¼ºæœå™¨é‹è¡Œæ­£å¸¸", when_unchecked: "" },
            { label: "å‚™ä»½è³‡æ–™åº«", when_checked: "- è³‡æ–™åº«å·²å®Œæˆå‚™ä»½", when_unchecked: "- è­¦å‘Šï¼šè³‡æ–™åº«æœªå‚™ä»½" },
            { label: "ç’°å¢ƒæ¸…æ½”", when_checked: "- è¾¦å…¬ç’°å¢ƒå·²æ•´ç†", when_unchecked: "" }
        ];

        // åˆå§‹åŒ–
        function init() {
            renderTasks();
            updateOutput();
        }

        function renderTasks() {
            const container = document.getElementById('task-list');
            container.innerHTML = '';
            tasks.forEach((task, index) => {
                const div = document.createElement('div');
                div.className = "flex items-center gap-3 p-2 hover:bg-[#2c2e33] rounded transition cursor-pointer";
                div.innerHTML = `
                    <input type="checkbox" id="task-${index}" onchange="updateOutput()">
                    <label for="task-${index}" class="flex-1 cursor-pointer select-none">${task.label}</label>
                `;
                container.appendChild(div);
            });
        }

        function updateOutput() {
            const now = new Date();
            const dateStr = `${now.getFullYear()}/${(now.getMonth()+1).toString().padStart(2, '0')}/${now.getDate().toString().padStart(2, '0')}`;
            
            let header = `${dateStr} å·¥è®€ç”Ÿäº¤æ¥:\nä»Šæ—¥å‡ºã€æ”¹å–®:\n\nä»Šæ—¥è¨­å®šWIFIæ©Ÿã€ç„¡ç´™åŒ–è¨­å®š:\n\nå…¶ä»–äº‹é …:\n`;
            let lines = [];
            let hasAny = false;

            tasks.forEach((task, index) => {
                const isChecked = document.getElementById(`task-${index}`).checked;
                const content = isChecked ? task.when_checked : task.when_unchecked;
                if (content) {
                    lines.push(content);
                    hasAny = true;
                }
            });

            let tail = "\nå·¥è®€ç”Ÿäº¤æ¥&ç¶­ä¿®:";
            if (!hasAny) tail += "(ç„¡ç‰¹æ®Šå›å ±äº‹é …)";

            const finalOutput = header + (lines.length > 0 ? lines.join('\n') + '\n' : "") + tail;
            document.getElementById('output-text').value = finalOutput;
        }

        function copyText() {
            const textArea = document.getElementById('output-text');
            navigator.clipboard.writeText(textArea.value).then(() => {
                alert("å…§å®¹å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼");
            });
        }

        function resetTasks() {
            selectAll(false);
        }

        function selectAll(bool) {
            tasks.forEach((_, index) => {
                document.getElementById(`task-${index}`).checked = bool;
            });
            updateOutput();
        }

        function playAudio() {
            const audio = document.getElementById('bg-audio');
            audio.currentTime = 0;
            audio.play().catch(e => alert("è«‹ç¢ºä¿ mp3.mp3 æ”¾åœ¨ç›¸åŒç›®éŒ„ä¸‹"));
        }

        // æ¨¡æ“¬å¾ tasks.txt æ ¼å¼åŒ¯å…¥
        function importTasks() {
            const raw = prompt("è«‹è²¼å…¥ tasks.txt çš„å…§å®¹ (æ ¼å¼: æ¨™ç±¤|é¸å–æ–‡å­—|æœªé¸æ–‡å­—)");
            if (!raw) return;

            const newTasks = [];
            const lines = raw.split('\n');
            lines.forEach(line => {
                if (!line.trim() || line.startsWith('#')) return;
                const parts = line.split('|').map(p => p.trim());
                if (parts.length >= 2) {
                    newTasks.push({
                        label: parts[0],
                        when_checked: parts[1],
                        when_unchecked: parts[2] || ""
                    });
                }
            });

            if (newTasks.length > 0) {
                tasks = newTasks;
                renderTasks();
                updateOutput();
            }
        }

        window.onload = init;
    </script>
</body>
</html>